function prev_not_comma(a,b){return(a.i_pe<=b)||(a.o_data[b-1]!=",")}_tsip_machine_parser_message_actions=[0,1,0,1,1,1,2,1,3,1,4,1,5,1,6,1,7,2,0,5,2,6,0];_tsip_machine_parser_message_key_offsets=[0,0,16,31,35,47,50,52,55,57,59,61,62,64,67,69,72,73,88,89,106,109,114,117,121,142,146,147,149,166,183,197,199,202,204,207,209,211,213,214,230,246,252,258,260,281,284,288];_tsip_machine_parser_message_trans_keys=[33,37,39,83,115,126,42,43,45,46,48,57,65,90,95,122,32,33,37,39,126,42,43,45,46,48,57,65,90,95,122,65,90,97,122,9,32,43,58,45,46,48,57,65,90,97,122,9,32,58,0,65535,32,0,65535,83,115,73,105,80,112,47,48,57,46,48,57,48,57,13,48,57,10,13,33,37,39,126,42,43,45,46,48,57,65,90,95,122,10,9,32,33,37,39,58,126,42,43,45,46,48,57,65,90,95,122,9,32,58,9,13,32,0,65535,13,0,65535,10,13,0,65535,13,33,37,39,44,47,126,0,41,42,57,58,64,65,90,91,94,95,122,123,65535,10,13,0,65535,10,9,32,32,33,37,39,73,105,126,42,43,45,46,48,57,65,90,95,122,32,33,37,39,80,112,126,42,43,45,46,48,57,65,90,95,122,32,33,37,39,47,126,42,43,45,57,65,90,95,122,48,57,46,48,57,48,57,32,48,57,48,57,48,57,48,57,32,9,13,37,61,95,126,32,33,36,59,63,90,97,122,128,255,9,13,37,61,95,126,32,33,36,59,63,90,97,122,128,255,48,57,65,70,97,102,48,57,65,70,97,102,0,65535,13,33,37,39,44,47,126,0,41,42,57,58,64,65,90,91,94,95,122,123,65535,13,0,65535,10,13,0,65535,10,13,0,65535,0];_tsip_machine_parser_message_single_lengths=[0,6,5,0,4,3,0,1,2,2,2,1,0,1,0,1,1,5,1,7,3,3,1,2,7,2,1,2,7,7,6,0,1,0,1,0,0,0,1,6,6,0,0,0,7,1,2,2];_tsip_machine_parser_message_range_lengths=[0,5,5,2,4,0,1,1,0,0,0,0,1,1,1,1,0,5,0,5,0,1,1,1,7,1,0,0,5,5,4,1,1,1,1,1,1,1,0,5,5,3,3,1,7,1,1,1];_tsip_machine_parser_message_index_offsets=[0,0,12,23,26,35,39,41,44,47,50,53,55,57,60,62,65,67,78,80,93,97,102,105,109,124,128,130,133,146,159,170,172,175,177,180,182,184,186,188,200,212,216,220,222,237,240,244];_tsip_machine_parser_message_indicies=[0,0,0,2,2,0,0,0,0,0,0,1,3,4,4,4,4,4,4,4,4,4,1,5,5,1,6,6,7,8,7,7,7,7,1,6,6,8,1,9,1,10,9,1,11,11,1,12,12,1,13,13,1,14,1,15,1,16,15,1,17,1,18,17,1,19,1,20,21,21,21,21,21,21,21,21,21,1,22,1,23,23,24,24,24,25,24,24,24,24,24,24,1,23,23,25,1,25,27,25,26,1,28,26,1,29,28,26,1,30,31,31,31,26,26,31,26,31,26,31,26,31,26,1,32,28,26,1,33,1,26,26,1,3,4,4,4,34,34,4,4,4,4,4,4,1,3,4,4,4,35,35,4,4,4,4,4,4,1,3,4,4,4,36,4,4,4,4,4,1,37,1,38,37,1,39,1,40,39,1,41,1,42,1,43,1,44,1,45,46,47,45,45,45,45,45,45,45,45,1,48,49,50,48,48,48,48,48,48,48,48,1,51,51,51,1,48,48,48,1,52,1,54,55,55,55,53,53,55,53,55,53,55,53,55,53,1,56,53,1,57,56,53,1,32,56,53,1,0];_tsip_machine_parser_message_trans_targs=[2,0,28,3,2,4,5,4,6,7,8,9,10,11,12,13,14,15,16,17,18,19,43,20,19,21,22,26,23,24,25,22,44,27,29,30,31,32,33,34,35,36,37,38,39,40,16,41,40,16,41,42,43,45,47,45,46,44];_tsip_machine_parser_message_trans_actions=[1,0,1,3,0,1,0,0,0,0,5,1,0,0,0,0,0,0,7,0,0,1,15,0,0,0,0,0,0,0,13,20,15,0,0,0,0,0,0,0,7,1,0,0,9,1,17,1,0,11,0,0,0,0,13,20,0,0];tsip_machine_parser_message_start=1;tsip_machine_parser_message_first_final=43;tsip_machine_parser_message_error=0;tsip_machine_parser_message_en_main=1;function tsip_message_parser_init(a){var b=0;b=tsip_machine_parser_message_start;a.i_cs=b}function tsip_message_parser_execute(u,s,f){var e=u.i_cs;var l=u.i_p;var w=u.i_pe;var i=u.i_eof;var x=u.o_data;var g,n,b,d,c,r,m;var o,j,a,q,v;var t;g=n=b=r=m=null;o=0;j=10;a=15;q=20;v=30;t=40;while(true){_trigger_goto=false;if(o<=0){if(l==w){o=v;continue}if(e==0){o=t;continue}}if(o<=j){b=_tsip_machine_parser_message_key_offsets[e];n=_tsip_machine_parser_message_index_offsets[e];g=_tsip_machine_parser_message_single_lengths[e];_break_match=false;do{if(g>0){_lower=b;_upper=b+g-1;while(true){if(_upper<_lower){break}_mid=_lower+((_upper-_lower)>>1);if(x[l]<_tsip_machine_parser_message_trans_keys[_mid]){_upper=_mid-1}else{if(x[l]>_tsip_machine_parser_message_trans_keys[_mid]){_lower=_mid+1}else{n+=(_mid-b);_break_match=true;break}}}if(_break_match){break}b+=g;n+=g}g=_tsip_machine_parser_message_range_lengths[e];if(g>0){_lower=b;_upper=b+(g<<1)-2;while(true){if(_upper<_lower){break}_mid=_lower+(((_upper-_lower)>>1)&~1);if(x[l]<_tsip_machine_parser_message_trans_keys[_mid]){_upper=_mid-2}else{if(x[l]>_tsip_machine_parser_message_trans_keys[_mid+1]){_lower=_mid+2}else{n+=((_mid-b)>>1);_break_match=true;break}}}if(_break_match){break}n+=g}}while(false);n=_tsip_machine_parser_message_indicies[n];e=_tsip_machine_parser_message_trans_targs[n];if(_tsip_machine_parser_message_trans_actions[n]!=0){r=_tsip_machine_parser_message_trans_actions[n];m=_tsip_machine_parser_message_actions[r];r+=1;while(m>0){m-=1;r+=1;switch(_tsip_machine_parser_message_actions[r-1]){case 0:u.i_tag_start=l;break;case 1:u.i_tag_end=l;if(s.e_type==tsip_message_type_e.UNKNOWN){s.e_type=tsip_message_type_e.REQUEST;if(!s.line.request.s_method){s.line.request.s_method=tsk_ragel_parser_get_string(u.s_data,l,u.i_tag_start);s.line.request.e_type=tsip_message.prototype.GetRequestType(s.line.request.s_method)}}else{u.cs=tsip_machine_parser_message_error}break;case 2:u.i_tag_end=l;if(!s.line.request.o_uri){var h=tsk_ragel_parser_get_string(u.s_data,l,u.i_tag_start);s.line.request.o_uri=tsip_uri.prototype.Parse(h)}break;case 3:u.i_tag_end=l;s.s_version=tsk_ragel_parser_get_string(u.s_data,l,u.i_tag_start);break;case 4:u.i_tag_end=l;if(s.e_type==tsip_message_type_e.UNKNOWN){s.e_type=tsip_message_type_e.RESPONSE;var k=tsk_ragel_parser_get_string(u.s_data,l,u.i_tag_start);s.line.response.i_status_code=parseInt(k)}else{u.i_cs=tsip_machine_parser_message_error}break;case 5:u.i_tag_end=l;if(!s.line.response.s_reason_phrase){s.line.response.s_reason_phrase=tsk_ragel_parser_get_string(u.s_data,l,u.i_tag_start)}break;case 6:u.i_tag_end=l;tsip_header_parse(u,s);break;case 7:u.i_cs=e;u.i_p=l;u.i_pe=w;u.i_eof=i;tsip_message_parser_eoh(u,s,f);e=u.i_cs;l=u.i_p;w=u.i_pe;i=u.i_eof;break}}}if(_trigger_goto){continue}}if(o<=q){if(e==0){o=t;continue}l+=1;if(l!=w){o=j;continue}}if(o<=v){}if(o<=t){break}}u.i_cs=e;u.i_p=l;u.i_pe=w;u.i_eof=i}function tsip_message_parser_eoh(b,h,a){if(h&&a){var g=h.get_content_length();if((b.i_p+g)<b.i_pe&&!h.o_content){var e=b.i_p+1;var f=(e+g);h.o_content=new Array((f-e));for(var d=e,c=0;d<f;++d,++c){h.o_content[c]=b.o_data[d]}b.i_p+=g}else{b.i_p=(b.i_pe-1)}}}tsip_message.prototype.Parse=function(b,a){var c=null;if(!b||!b.o_data){return null}c=new tsip_message(tsip_message_type_e.UNKNOWN);tsip_message_parser_init(b);tsip_message_parser_execute(b,c,a);if(b.i_cs<43){tsk_utils_log_error("Failed to parse message: "+b.s_data);return null}return c};