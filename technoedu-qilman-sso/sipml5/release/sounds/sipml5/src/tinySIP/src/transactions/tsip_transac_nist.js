tsip_transac_nist.prototype=Object.create(tsip_transac.prototype);tsip_transac_nist.prototype.__b_debug_state_machine=false;var tsip_transac_nist_actions_e={CANCEL:tsip_action_type_e.CANCEL,RECV_REQUEST:10001,SEND_1XX:10002,SEND_200_to_699:10003,TIMER_J:10004,TRANSPORT_ERROR:10007,ERROR:10008};var tsip_transac_nist_states_e={STARTED:0,TRYING:1,PROCEEDING:2,COMPLETED:3,TERMINATED:4};function tsip_transac_nist(b,f,d,c,e){var a;if(!e||!(a=e.get_stack())){tsk_utils_log_error("Invalid argument");return null}tsip_transac.call(this);this.o_lastResponse=null;this.init(tsip_transac_type_e.nist,b,f,d,c,e,tsip_transac_nist_states_e.STARTED,tsip_transac_nist_states_e.TERMINATED);this.set_callback(__tsip_transac_nist_event_callback);this.o_fsm.set_debug_enabled(tsip_transac_nist.prototype.__b_debug_state_machine);this.o_fsm.set_onterm_callback(__tsip_transac_nist_onterm,this);this.o_timerJ=null;this.i_timerJ=b?0:a.o_timers.getJ();this.o_fsm.set(tsk_fsm_entry.prototype.CreateAlways(tsip_transac_nist_states_e.STARTED,tsip_transac_nist_actions_e.RECV_REQUEST,tsip_transac_nist_states_e.TRYING,tsip_transac_nist_Started_2_Trying_X_request,"tsip_transac_nist_Started_2_Trying_X_request"),tsk_fsm_entry.prototype.CreateAlwaysNothing(tsip_transac_nist_states_e.STARTED,"tsip_transac_nist_Started_2_Started_X_any"),tsk_fsm_entry.prototype.CreateAlways(tsip_transac_nist_states_e.TRYING,tsip_transac_nist_actions_e.SEND_1XX,tsip_transac_nist_states_e.PROCEEDING,tsip_transac_nist_Trying_2_Proceeding_X_send_1xx,"tsip_transac_nist_Trying_2_Proceeding_X_send_1xx"),tsk_fsm_entry.prototype.CreateAlways(tsip_transac_nist_states_e.TRYING,tsip_transac_nist_actions_e.SEND_200_to_699,tsip_transac_nist_states_e.COMPLETED,tsip_transac_nist_Trying_2_Completed_X_send_200_to_699,"tsip_transac_nist_Trying_2_Completed_X_send_200_to_699"),tsk_fsm_entry.prototype.CreateAlways(tsip_transac_nist_states_e.PROCEEDING,tsip_transac_nist_actions_e.SEND_1XX,tsip_transac_nist_states_e.PROCEEDING,tsip_transac_nist_Proceeding_2_Proceeding_X_send_1xx,"tsip_transac_nist_Proceeding_2_Proceeding_X_send_1xx"),tsk_fsm_entry.prototype.CreateAlways(tsip_transac_nist_states_e.PROCEEDING,tsip_transac_nist_actions_e.SEND_200_to_699,tsip_transac_nist_states_e.COMPLETED,tsip_transac_nist_Proceeding_2_Completed_X_send_200_to_699,"tsip_transac_nist_Proceeding_2_Completed_X_send_200_to_699"),tsk_fsm_entry.prototype.CreateAlways(tsip_transac_nist_states_e.PROCEEDING,tsip_transac_nist_actions_e.RECV_REQUEST,tsip_transac_nist_states_e.PROCEEDING,tsip_transac_nist_Proceeding_2_Proceeding_X_request,"tsip_transac_nist_Proceeding_2_Proceeding_X_request"),tsk_fsm_entry.prototype.CreateAlways(tsip_transac_nist_states_e.COMPLETED,tsip_transac_nist_actions_e.RECV_REQUEST,tsip_transac_nist_states_e.COMPLETED,tsip_transac_nist_Completed_2_Completed_X_request,"tsip_transac_nist_Completed_2_Completed_X_request"),tsk_fsm_entry.prototype.CreateAlways(tsip_transac_nist_states_e.COMPLETED,tsip_transac_nist_actions_e.TIMER_J,tsip_transac_nist_states_e.TERMINATED,tsip_transac_nist_Completed_2_Terminated_X_tirmerJ,"tsip_transac_nist_Completed_2_Terminated_X_tirmerJ"),tsk_fsm_entry.prototype.CreateAlways(tsk_fsm.prototype.__i_state_any,tsip_transac_nist_actions_e.TRANSPORT_ERROR,tsip_transac_nist_states_e.TERMINATED,tsip_transac_nist_Any_2_Terminated_X_transportError,"tsip_transac_nist_Any_2_Terminated_X_transportError"),tsk_fsm_entry.prototype.CreateAlways(tsk_fsm.prototype.__i_state_any,tsip_transac_nist_actions_e.ERROR,tsip_transac_nist_states_e.TERMINATED,tsip_transac_nist_Any_2_Terminated_X_Error,"tsip_transac_nist_Any_2_Terminated_X_Error"),tsk_fsm_entry.prototype.CreateAlways(tsk_fsm.prototype.__i_state_any,tsip_transac_nist_actions_e.CANCEL,tsip_transac_nist_states_e.TERMINATED,tsip_transac_nist_Any_2_Terminated_X_cancel,"tsip_transac_nist_Any_2_Terminated_X_cancel"))}tsip_transac_nist.prototype.start=function(a){var b=-1;if(a&&!this.b_running){this.b_running=true;b=this.fsm_act(tsip_transac_nist_actions_e.RECV_REQUEST,a)}return b};function tsip_transac_nist_Started_2_Trying_X_request(a){var b=a[0];var c=a[1];return b.get_dialog().callback(tsip_dialog_event_type_e.I_MSG,c)}function tsip_transac_nist_Trying_2_Proceeding_X_send_1xx(a){var b=a[0];var c=a[1];var d;d=b.send(this.s_branch,c)>0?0:-1;b.o_lastResponse=c;return d}function tsip_transac_nist_Trying_2_Completed_X_send_200_to_699(a){var b=a[0];var c=a[1];var d;d=b.send(this.s_branch,c)>0?0:-1;b.timer_schedule("nist","J");b.o_lastResponse=c;return d}function tsip_transac_nist_Proceeding_2_Proceeding_X_send_1xx(a){var b=a[0];var c=a[1];b.o_lastResponse=c;return b.send(this.s_branch,c)>0?0:-1}function tsip_transac_nist_Proceeding_2_Proceeding_X_request(a){var b=a[0];if(b.o_lastResponse){b.send(this.s_branch,b.o_lastResponse)}return 0}function tsip_transac_nist_Proceeding_2_Completed_X_send_200_to_699(a){var b=a[0];var c=a[1];var d;d=b.send(this.s_branch,c)>0?0:-1;b.timer_schedule("nist","J");b.o_lastResponse=c;return d}function tsip_transac_nist_Completed_2_Completed_X_request(a){var b=a[0];if(b.o_lastResponse){b.send(this.s_branch,b.o_lastResponse)}return 0}function tsip_transac_nist_Completed_2_Terminated_X_tirmerJ(a){return 0}function tsip_transac_nist_Any_2_Terminated_X_transportError(a){var b=a[0];return b.get_dialog().callback(tsip_dialog_event_type_e.TRANSPORT_ERROR,null)}function tsip_transac_nist_Any_2_Terminated_X_Error(a){var b=a[0];return b.get_dialog().callback(tsip_dialog_event_type_e.ERROR,null)}function tsip_transac_nist_Any_2_Terminated_X_cancel(a){return 0}function __tsip_transac_nist_onterm(a){a.timer_cancel("J");return a.deinit()}function __tsip_transac_nist_event_callback(a,c,b){var d=-1;switch(c){case tsip_transac_event_type_e.INCOMING_MSG:if(b&&b.is_request()){d=a.fsm_act(tsip_transac_nist_actions_e.RECV_REQUEST,b)}break;case tsip_transac_event_type_e.OUTGOING_MSG:if(b&&b.is_response()){if(b.is_1xx()){d=a.fsm_act(tsip_transac_nist_actions_e.SEND_1XX,b)}else{if(b.is_23456()){d=a.fsm_act(tsip_transac_nist_actions_e.SEND_200_to_699,b)}}}break;case tsip_transac_event_type_e.CANCELED:case tsip_transac_event_type_e.TERMINATED:case tsip_transac_event_type_e.TIMEDOUT:break;case tsip_transac_event_type_e.ERROR:d=a.fsm_act(tsip_transac_nist_actions_e.ERROR,b);break;case tsip_transac_event_type_e.TRANSPORT_ERROR:d=a.fsm_act(tsip_transac_nist_actions_e.TRANSPORT_ERROR,b);break}return d}function __tsip_transac_nist_timer_callback(b,a){if(b){if(a==b.o_timerJ){b.fsm_act(tsip_transac_nist_actions_e.TIMER_J,null)}}};