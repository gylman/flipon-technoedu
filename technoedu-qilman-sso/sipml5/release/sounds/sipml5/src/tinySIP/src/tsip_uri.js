var tsip_uri_type_e={unknown:{i_id:0,s_scheme:"unknown"},sip:{i_id:1,s_scheme:"sip"},sips:{i_id:2,s_scheme:"sips"},tel:{i_id:3,s_scheme:"tel"}};var tsip_host_type_e={unknown:{i_id:0,s_name:"unknown"},hostname:{i_id:1,s_name:"hostname"},ipv4:{i_id:2,s_name:"ipv4"},ipv6:{i_id:3,s_name:"ipv6"}};function tsip_uri(a){this.e_type=a;this.s_scheme=null;this.s_host=null;this.e_host_type=tsip_host_type_e.unknown;this.i_port=0;this.s_user_name=null;this.s_password=null;this.s_display_name=null;this.ao_params=new Array();this.toString=function(){return tsip_uri_tostring(this,true,true)}}tsip_uri.prototype.tostring=function(a,b){return tsip_uri_tostring(this,a,b)};tsip_uri.prototype.compare=function(a){var b=tsip_uri_compare(this,a)};tsip_uri.prototype.clone=function(b,c){var a=tsip_uri_tostring(this,b,c);if(a){return tsip_uri.prototype.Parse(a)}return null};function tsip_uri_make_valid(b,a){if(!b||!a){tsk_utils_log_error("Invalid argument");return null}if(tsk_string_index_of(b,b.length,'"')==0||tsk_string_index_of(b,b.length,"<")==0){return tsip_uri.prototype.Parse(b)}var c=(tsk_string_index_of(b,b.length,"tel:")==0);if(tsk_string_index_of(b,b.length,"sip:")!=0&&tsk_string_index_of(b,b.length,"sips:")!=0&&!c){b="sip:"+b}if(!c&&tsk_string_index_of(b,b.length,"@")==-1){b+="@"+a}return tsip_uri.prototype.Parse(b)}function __tsip_uri_tostring(a,c){var b=tsk_string_format("{0}:{1}{2}{3}{4}{5}{6}{7}{8}{9}",a.s_scheme?a.s_scheme:"sip",a.s_user_name?a.s_user_name:"",a.s_password?":":"",a.s_password?a.s_password:"",a.s_host?(a.s_user_name?"@":""):"",a.e_host_type==tsip_host_type_e.ipv6?"[":"",a.s_host?a.s_host:"",a.e_host_type==tsip_host_type_e.ipv6?"]":"",a.i_port>0?":":"",a.i_port>0?a.i_port:"");if(b&&c&&a.ao_params.length>0){b+=tsk_string_format(";{0}",tsk_params_tostring(a.ao_params,";"))}return b}function tsip_uri_tostring(a,c,d){if(a){if(d){var b="";if(a.s_display_name){b+=tsk_string_format('"{0}"',a.s_display_name)}b+=tsk_string_format("<{0}>",__tsip_uri_tostring(a,c));return b}else{return __tsip_uri_tostring(a,c)}}else{tsk_utils_log_error("Invalid argument");return null}}function tsip_uri_strcmp(c,a,d){if(c&&a){var b=false;var e=false;if(tsk_string_contains(c,c.length,"%")){b=true;c=decodeURIComponent(c)}if(tsk_string_contains(a,a.length,"%")){e=true;a=decodeURIComponent(a)}return d?c.localeCompare(a):c.toLowerCase().localeCompare(a.toLowerCase())}return -1}function tsip_uri_strequals(b,a){return(tsip_uri_strcmp(b,a,true)==0)}function tsip_uri_striequals(b,a){return(tsip_uri_strcmp(b,a,false)==0)}function tsip_uri_compare_parameter(c,a,b){var e=tsk_param_get_by_name(c.ao_params,b);var d=tsk_param_get_by_name(a.ao_params,b);if((e||d)&&((e&&!d)||(!e&&d)||(!tsip_uri_striequals(e.s_value,d.s_value)))){return -3}return 0}function tsip_uri_compare(c,a){if(c&&a){var f;var e;var d;if(!tsk_string_equals(c.s_scheme,a.s_scheme)||!tsip_uri_strequals(c.s_user_name,a.s_user_name)||!tsip_uri_strequals(c.s_host,a.s_host)||!tsk_string_equals(c.s_password,a.s_password)||c.i_port!=a.i_port){return -2}if((!c.ao_params&&!a.ao_params)||(c.ao_params.length==0&&a.ao_params.length==0)){return 0}if((d=tsip_uri_compare_parameter(c,a,"transport"))!=0){return d}if((d=tsip_uri_compare_parameter(c,a,"ttl"))!=0){return d}if((d=tsip_uri_compare_parameter(c,a,"user"))!=0){return d}if((d=tsip_uri_compare_parameter(c,a,"method"))!=0){return d}if((d=tsip_uri_compare_parameter(c,a,"maddr"))!=0){return d}for(var b=0;b<c.ao_params.length;++b){f=c.ao_params[b];if((e=tsk_param_get_by_name(a.ao_params,f.s_name))){if(!tsip_uri_striequals(f.s_value,e.s_value)){return -4}}}for(var b=0;b<a.ao_params.length;++b){e=a.ao_params[b];if((f=tsk_param_get_by_name(c.ao_params,e.s_name))){if(!tsip_uri_striequals(f.s_value,e.s_value)){return -4}}}return 0}else{return(!c&&!a)?0:-1}}if(!window.__b_release_mode){tsip_api_add_js_scripts("head","src/tinySIP/src/parsers/tsip_parser_uri.js")};