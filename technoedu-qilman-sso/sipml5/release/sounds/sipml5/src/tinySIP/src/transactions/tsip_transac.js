tsip_transac.prototype.__magic_cookie="z9hG4bK";var tsip_transac_event_type_e={INCOMING_MSG:0,OUTGOING_MSG:1,CANCELED:2,TERMINATED:3,TIMEDOUT:4,ERROR:5,TRANSPORT_ERROR:6};var tsip_transac_type_e={NONE:-1,ICT:0,IST:1,NICT:2,NIST:3};function tsip_transac(){this.e_type=tsip_transac_type_e.NONE;this.o_dialog=null;this.o_fsm=null;this.b_reliable=true;this.b_running=false;this.b_initialized=false;this.s_branch=null;this.i_cseq_value=0;this.s_cseq_method=null;this.s_callid=null;this.fn_callback=null}tsip_transac.prototype.init=function(c,b,h,f,e,g,d,a){if(!this.b_initialized){this.e_type=c;this.b_reliable=b;this.i_cseq_value=h;this.s_cseq_method=f;this.s_callid=e;this.o_dialog=g;this.o_fsm=new tsk_fsm(d,a,null,this);this.b_initialized=true}return 0};tsip_transac.prototype.deinit=function(){this.get_stack().o_layer_transac.remove(this);this.b_initialized=false;return 0};tsip_transac.prototype.timer_schedule=function(T,N){this.timer_cancel(N);var This=this;var s_code=tsk_string_format("This.o_timer{1} = setTimeout(function(){ __tsip_transac_{0}_timer_callback(This, This.o_timer{1})}, This.i_timer{1});",T,N);eval(s_code)};tsip_transac.prototype.timer_cancel=function(N){var s_code=tsk_string_format("if(this.o_timer{0}) { clearTimeout(this.o_timer{0}); this.o_timer{0} = null; }",N);eval(s_code)};tsip_transac.prototype.set_callback=function(a){this.fn_callback=a};tsip_transac.prototype.send=function(b,a){return this.get_stack().o_layer_transport.send(b,a)};tsip_transac.prototype.callback=function(b,a){if(this.fn_callback){return this.fn_callback(this,b,a)}tsk_utils_log_error("Invalid callback function");return -1};tsip_transac.prototype.get_type=function(){return this.e_type};tsip_transac.prototype.get_fsm=function(){return this.o_fsm};tsip_transac.prototype.get_dialog=function(){return this.o_dialog};tsip_transac.prototype.get_session=function(){if(this.o_dialog){return this.o_dialog.o_session}return null};tsip_transac.prototype.get_stack=function(){var a=this.get_session();if(a){return a.o_stack}return null};tsip_transac.prototype.fsm_act=function(a,b){if(!this.o_fsm){tsk_utils_log_error("Invalid argument");return -1}return this.o_fsm.act(a,this,b,this,b)};tsip_transac.prototype.send=function(c,b){var a=this.get_stack();if(!a||!a.o_layer_transport){tsk_utils_log_error("Invalid state");return -1}return a.o_layer_transport.send(c,b)};tsip_transac.prototype.compare=function(a){return tsip_transac_compare(this,a)};function tsip_transac_compare(b,a){if(b&&a){if((b.s_branch==a.s_branch)&&(b.s_cseq_method==a.s_cseq_method)){return 0}}return -1}if(!window.__b_release_mode){tsip_api_add_js_scripts("head","src/tinySIP/src/transactions/tsip_transac_ict.js","src/tinySIP/src/transactions/tsip_transac_ist.js","src/tinySIP/src/transactions/tsip_transac_layer.js","src/tinySIP/src/transactions/tsip_transac_nict.js","src/tinySIP/src/transactions/tsip_transac_nist.js")};