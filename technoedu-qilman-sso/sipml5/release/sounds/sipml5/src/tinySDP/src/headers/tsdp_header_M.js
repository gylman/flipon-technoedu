tsdp_header_M.prototype=Object.create(tsdp_header.prototype);_tsdp_machine_parser_header_M_actions=[0,1,0,1,1,1,2,1,3,1,4];_tsdp_machine_parser_header_M_key_offsets=[0,0,1,3,18,33,35,39,53,54,68,70,73,88,88,103];_tsdp_machine_parser_header_M_trans_keys=[109,32,61,32,33,37,39,126,42,43,45,46,48,57,65,90,95,122,32,33,37,39,126,42,43,45,46,48,57,65,90,95,122,48,57,32,47,48,57,33,37,39,126,42,43,45,46,48,57,65,90,95,122,10,33,37,39,126,42,43,45,46,48,57,65,90,95,122,48,57,32,48,57,13,32,33,37,39,47,126,42,43,45,57,65,90,95,122,13,33,37,39,126,42,43,45,46,48,57,65,90,95,122,13,32,33,37,39,126,42,43,45,46,48,57,65,90,95,122,0];_tsdp_machine_parser_header_M_single_lengths=[0,1,2,5,5,0,2,4,1,4,0,1,7,0,5,6];_tsdp_machine_parser_header_M_range_lengths=[0,0,0,5,5,1,1,5,0,5,1,1,4,0,5,5];_tsdp_machine_parser_header_M_index_offsets=[0,0,2,5,16,27,29,33,43,45,55,57,60,72,73,84];_tsdp_machine_parser_header_M_indicies=[0,1,0,2,1,2,3,3,3,3,3,3,3,3,3,1,4,5,5,5,5,5,5,5,5,5,1,6,1,7,8,9,1,10,10,10,10,10,10,10,10,10,1,11,1,12,12,12,12,12,12,12,12,12,1,13,1,7,14,1,15,16,12,12,12,17,12,12,12,12,12,1,1,18,19,19,19,19,19,19,19,19,19,1,20,21,22,22,22,22,22,22,22,22,22,1,0];_tsdp_machine_parser_header_M_trans_targs=[2,0,3,4,5,4,6,7,10,6,12,13,12,11,11,8,14,9,8,15,8,14,15];_tsdp_machine_parser_header_M_trans_actions=[0,0,0,1,3,0,1,5,5,0,1,0,0,1,0,7,7,0,0,1,9,9,0];_tsdp_machine_parser_header_M_eof_actions=[0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,9];tsdp_machine_parser_header_M_start=1;tsdp_machine_parser_header_M_first_final=12;tsdp_machine_parser_header_M_error=0;tsdp_machine_parser_header_M_en_main=1;function tsdp_header_M(c,b,a){tsdp_header.call(this,tsdp_header_type_e.M);this.s_media=c;this.i_port=b;this.i_nports=0;this.s_proto=a;this.as_fmt=new Array();this.o_hdr_I=null;this.o_hdr_C=null;this.ao_hdr_B=new Array();this.o_hdr_K=null;this.ao_hdr_A=new Array();this.ao_hdr_Dummy=new Array()}tsdp_header_M.prototype.toString=function(c){if(!c){c="\r\n"}var d=tsk_string_format("{0} {1}{2}{3} {4}",this.s_media,this.i_port,this.i_nports?"/":"",this.i_nports?this.i_nports:"",this.s_proto);for(var b=0;b<this.as_fmt.length;++b){d+=" "+this.as_fmt[b]}var a=!this.o_hdr_I&&!this.o_hdr_C&&this.ao_hdr_B.length==0&&!this.o_hdr_K&&this.ao_hdr_A.length.length==0;if(a){return d}d+=c;if(this.o_hdr_I){d+=this.o_hdr_I.tostring_full(false,c)}if(this.o_hdr_C){d+=this.o_hdr_C.tostring_full(false,c)}for(var b=0;b<this.ao_hdr_B.length;++b){d+=this.ao_hdr_B[b].tostring_full(false,c)}if(this.o_hdr_K){d+=this.o_hdr_K.tostring_full(false,c)}for(var b=0;b<this.ao_hdr_A.length;++b){d+=this.ao_hdr_A[b].tostring_full(false,c)}for(var b=0;b<this.ao_hdr_Dummy.length;++b){d+=this.ao_hdr_Dummy[b].tostring_full(false,c)}return d.substring(0,d.length-c.length)};tsdp_header_M.prototype.remove_header=function(a){switch(a){case tsdp_header_type_e.I:this.o_hdr_I=null;break;case tsdp_header_type_e.C:this.o_hdr_C=null;break;case tsdp_header_type_e.B:this.ao_hdr_B.splice(0,this.ao_hdr_B.length);break;case tsdp_header_type_e.K:this.o_hdr_K=null;break}return 0};tsdp_header_M.prototype.add_header=function(a){if(!a){tsk_utils_log_error("Invalid argument");return -1}switch(a.e_type){case tsdp_header_type_e.I:this.o_hdr_I=a;break;case tsdp_header_type_e.C:this.o_hdr_C=a;break;case tsdp_header_type_e.B:this.ao_hdr_B.push(a);break;case tsdp_header_type_e.K:this.o_hdr_K=a;break;case tsdp_header_type_e.A:this.ao_hdr_A.push(a);break}return 0};tsdp_header_M.prototype.add_fmt=function(a){if(a){this.as_fmt.push(a)}};tsdp_header_M.prototype.add_headers=function(){for(var a=0;a<arguments.length;++a){if(arguments[a]){this.add_header(arguments[a])}}};tsdp_header_M.prototype.find_a_at=function(d,c){if(!d||c<0){tsk_utils_log_error("Invalid argument");return null}var a=0;for(var b=0;b<this.ao_hdr_A.length;++b){if(this.ao_hdr_A[b].s_field==d){if(a++>=c){return this.ao_hdr_A[b]}}}return null};tsdp_header_M.prototype.find_a=function(a){return this.find_a_at(a,0)};tsdp_header_M.prototype.get_rtpmap=function(g){var b=g?g.length:0;if(b<=0||b>3){tsk_utils_log_error("Invalid argument");return null}var f=null;var a,e=0;var d;var c;while((c=this.find_a_at(e++))){if((a=c.s_value?c.s_value.length:0)<(b+1)){continue}if((d=tsk_string_index_of(c.s_value,a,g))==0&&(c.s_value[b]==" ")){f=c.s_value.substring(b+1,A_len);break}}return f};tsdp_header_M.prototype.get_fmtp=function(g){var b=g?g.length:0;if(b<=0||b>3){tsk_utils_log_error("Invalid argument");return null}var f=null;var a,e=0;var d;var c;while((c=this.find_a_at(e++))){if((a=c.s_value?c.s_value.length:0)<(b+1)){continue}if((d=tsk_string_index_of(c.s_value,a,g))==0&&(c.s_value[b]==" ")){f=c.s_value.substring(b+1,A_len);break}}return f};tsdp_header_M.prototype.hold=function(a){var c;if((c=this.find_a(a?"recvonly":"sendonly"))){c.s_field=a?"inactive":"recvonly"}else{if((c=this.find_a("sendrecv"))){c.s_field=a?"sendonly":"recvonly"}else{if(!(c=this.find_a(a?"sendonly":"recvonly"))&&!(c=this.find_a("inactive"))){var b;if((b=new tsdp_header_A(a?"sendonly":"recvonly",null))){this.add_header(b)}}}}return 0};tsdp_header_M.prototype.set_holdresume_att=function(e,b){var d;var c=[["sendrecv","recvonly"],["sendonly","inactive"]];if((d=this.find_a("sendrecv"))||(d=this.find_a("sendonly"))||(d=this.find_a("recvonly"))||(d=this.find_a("inactive"))){d.s_field=c[e?1:0][b?1:0]}else{var a;if((a=new tsdp_header_A(c[e?1:0][b?1:0],null))){this.add_headers(a)}}return 0};tsdp_header_M.prototype.is_held=function(a){if(this.find_a("inactive")){return true}if(a){return this.find_a("recvonly")?true:false}else{return this.find_a("sendonly")?true:false}};tsdp_header_M.prototype.resume=function(a){var b;if((b=this.find_a("inactive"))){b.s_field=a?"recvonly":"sendonly"}else{if((b=this.find_a(a?"sendonly":"recvonly"))){b.s_field=sendrecv}}return 0};tsdp_header_M.prototype.Parse=function(k){var e=0;var i=0;var u=k.length;var g=u;var v=tsk_buff_str2ib(k);var t;var o=new tsdp_header_M(null,0,null);e=tsdp_machine_parser_header_M_start;var f,l,b,d,c,q,j;var m,h,a,n,s;var r;f=l=b=q=j=null;m=0;h=10;a=15;n=20;s=30;r=40;while(true){_trigger_goto=false;if(m<=0){if(i==u){m=s;continue}if(e==0){m=r;continue}}if(m<=h){b=_tsdp_machine_parser_header_M_key_offsets[e];l=_tsdp_machine_parser_header_M_index_offsets[e];f=_tsdp_machine_parser_header_M_single_lengths[e];_break_match=false;do{if(f>0){_lower=b;_upper=b+f-1;while(true){if(_upper<_lower){break}_mid=_lower+((_upper-_lower)>>1);if(v[i]<_tsdp_machine_parser_header_M_trans_keys[_mid]){_upper=_mid-1}else{if(v[i]>_tsdp_machine_parser_header_M_trans_keys[_mid]){_lower=_mid+1}else{l+=(_mid-b);_break_match=true;break}}}if(_break_match){break}b+=f;l+=f}f=_tsdp_machine_parser_header_M_range_lengths[e];if(f>0){_lower=b;_upper=b+(f<<1)-2;while(true){if(_upper<_lower){break}_mid=_lower+(((_upper-_lower)>>1)&~1);if(v[i]<_tsdp_machine_parser_header_M_trans_keys[_mid]){_upper=_mid-2}else{if(v[i]>_tsdp_machine_parser_header_M_trans_keys[_mid+1]){_lower=_mid+2}else{l+=((_mid-b)>>1);_break_match=true;break}}}if(_break_match){break}l+=f}}while(false);l=_tsdp_machine_parser_header_M_indicies[l];e=_tsdp_machine_parser_header_M_trans_targs[l];if(_tsdp_machine_parser_header_M_trans_actions[l]!=0){q=_tsdp_machine_parser_header_M_trans_actions[l];j=_tsdp_machine_parser_header_M_actions[q];q+=1;while(j>0){j-=1;q+=1;switch(_tsdp_machine_parser_header_M_actions[q-1]){case 0:t=i;break;case 1:o.s_media=tsk_ragel_parser_get_string(k,i,t);break;case 2:o.i_port=tsk_ragel_parser_get_int(k,i,t);break;case 3:o.s_proto=tsk_ragel_parser_get_string(k,i,t);break;case 4:tsk_ragel_parser_add_string(k,i,t,o.as_fmt);break}}}if(_trigger_goto){continue}}if(m<=n){if(e==0){m=r;continue}i+=1;if(i!=u){m=h;continue}}if(m<=s){if(i==g){__acts=_tsdp_machine_parser_header_M_eof_actions[e];__nacts=_tsdp_machine_parser_header_M_actions[__acts];__acts+=1;while(__nacts>0){__nacts-=1;__acts+=1;switch(_tsdp_machine_parser_header_M_actions[__acts-1]){case 3:o.s_proto=tsk_ragel_parser_get_string(k,i,t);break;case 4:tsk_ragel_parser_add_string(k,i,t,o.as_fmt);break}}if(_trigger_goto){continue}}}if(m<=r){break}}if(e<12){tsk_utils_log_error('Failed to parse "m=" header: '+k);return null}return o};