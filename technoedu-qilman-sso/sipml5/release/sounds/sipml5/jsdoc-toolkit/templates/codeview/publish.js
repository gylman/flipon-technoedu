function publish(b){publish.conf={ext:".html",outDir:JSDOC.opt.d||SYS.pwd+"../out/jsdoc/",templatesDir:JSDOC.opt.t||SYS.pwd+"../templates/jsdoc/",staticDir:"static/",symbolsDir:"symbols/",srcDir:"symbols/src/",cssDir:"css/",fontsDir:"css/fonts/",jsDir:"javascript/",templateName:"Codeview",templateVersion:"1.2",templateLink:"http://www.thebrightlines.com/2010/05/06/new-template-for-jsdoctoolkit-codeview/"};if(JSDOC.opt.s&&defined(Link)&&Link.prototype._makeSrcLink){Link.prototype._makeSrcLink=function(e){return"&lt;"+e+"&gt;"}}IO.mkPath((publish.conf.outDir+publish.conf.cssDir));IO.mkPath((publish.conf.outDir+publish.conf.fontsDir));IO.mkPath((publish.conf.outDir+publish.conf.jsDir));IO.mkPath((publish.conf.outDir+"symbols/src").split("/"));Link.symbolSet=b;try{var p=new JSDOC.JsPlate(publish.conf.templatesDir+"class.tmpl")}catch(v){print("Couldn't create the required templates: "+v);quit()}function n(e){return(e.memberOf=="")}function w(e){return(e.is("FILE"))}function m(e){return((e.is("CONSTRUCTOR")||e.isNamespace)&&(e.alias!="_global_"||!JSDOC.opt.D.noGlobal))}var a=b.toArray();var f=JSDOC.opt.srcFiles;for(var t=0,q=f.length;t<q;t++){var x=f[t];var c=publish.conf.outDir+publish.conf.srcDir;makeSrcFile(x,c)}publish.classes=a.filter(m).sort(makeSortby("alias"));if(JSDOC.opt.u){var o={};Link.filemap={};for(var t=0,q=publish.classes.length;t<q;t++){var z=publish.classes[t].alias.toLowerCase();if(!o[z]){o[z]=1}else{o[z]++}Link.filemap[publish.classes[t].alias]=(o[z]>1)?z+"_"+o[z]:z}}for(var t=0,q=publish.classes.length;t<q;t++){var r=publish.classes[t];r.events=r.getEvents();r.methods=r.getMethods();var j="";j=p.process(r);IO.saveFile(publish.conf.outDir+publish.conf.symbolsDir,((JSDOC.opt.u)?Link.filemap[r.alias]:r.alias)+publish.conf.ext,j)}try{var y=new JSDOC.JsPlate(publish.conf.templatesDir+"allclasses.tmpl")}catch(v){print(v.message);quit()}var h=y.process(publish.classes);IO.saveFile(publish.conf.outDir,(JSDOC.opt.D.index=="files"?"allclasses":"index")+publish.conf.ext,h);y=h=classes=null;try{var s=new JSDOC.JsPlate(publish.conf.templatesDir+"allfiles.tmpl")}catch(v){print(v.message);quit()}var k=a.filter(w);var d=[];for(var t=0;t<f.length;t++){d.push(new JSDOC.Symbol(f[t],[],"FILE",new JSDOC.DocComment("/** */")))}for(var t=0;t<k.length;t++){var g=f.indexOf(k[t].alias);d[g]=k[t]}d=d.sort(makeSortby("name"));var u=s.process(d);IO.saveFile(publish.conf.outDir,(JSDOC.opt.D.index=="files"?"index":"files")+publish.conf.ext,u);s=u=f=null;IO.copyFile(publish.conf.templatesDir+"/"+publish.conf.cssDir+"all.css",publish.conf.outDir+"/"+publish.conf.cssDir);IO.copyFile(publish.conf.templatesDir+"/"+publish.conf.cssDir+"screen.css",publish.conf.outDir+"/"+publish.conf.cssDir);IO.copyFile(publish.conf.templatesDir+"/"+publish.conf.cssDir+"handheld.css",publish.conf.outDir+"/"+publish.conf.cssDir);IO.copyFile(publish.conf.templatesDir+"/"+publish.conf.jsDir+"all.js",publish.conf.outDir+"/"+publish.conf.jsDir);IO.copyFile(publish.conf.templatesDir+"/"+publish.conf.jsDir+"html5.js",publish.conf.outDir+"/"+publish.conf.jsDir);IO.copyFile(publish.conf.templatesDir+"/"+publish.conf.fontsDir+"mplus-1m-regular-webfont.eot",publish.conf.outDir+"/"+publish.conf.fontsDir);IO.copyFile(publish.conf.templatesDir+"/"+publish.conf.fontsDir+"mplus-1m-regular-webfont.svg",publish.conf.outDir+"/"+publish.conf.fontsDir);IO.copyFile(publish.conf.templatesDir+"/"+publish.conf.fontsDir+"mplus-1m-regular-webfont.ttf",publish.conf.outDir+"/"+publish.conf.fontsDir);IO.copyFile(publish.conf.templatesDir+"/"+publish.conf.fontsDir+"mplus-1m-regular-webfont.woff",publish.conf.outDir+"/"+publish.conf.fontsDir);IO.copyFile(publish.conf.templatesDir+"/"+publish.conf.fontsDir+"mplus-1m-bold-webfont.eot",publish.conf.outDir+"/"+publish.conf.fontsDir);IO.copyFile(publish.conf.templatesDir+"/"+publish.conf.fontsDir+"mplus-1m-bold-webfont.svg",publish.conf.outDir+"/"+publish.conf.fontsDir);IO.copyFile(publish.conf.templatesDir+"/"+publish.conf.fontsDir+"mplus-1m-bold-webfont.ttf",publish.conf.outDir+"/"+publish.conf.fontsDir);IO.copyFile(publish.conf.templatesDir+"/"+publish.conf.fontsDir+"mplus-1m-bold-webfont.woff",publish.conf.outDir+"/"+publish.conf.fontsDir)}function subtemplate(a,b){try{return new JSDOC.JsPlate(publish.conf.templatesDir+a).process(b)}catch(c){print(c.message);quit()}}function summarize(a){if(typeof a!="undefined"){return a.match(/([\w\W]+?\.)[^a-z0-9_$]/i)?RegExp.$1:a}}function makeSortby(a){return function(d,c){if(d[a]!=undefined&&c[a]!=undefined){d=d[a].toLowerCase();c=c[a].toLowerCase();if(d<c){return -1}if(d>c){return 1}return 0}}}function wordwrapNamespace(c){var a=c.match(/[^<>]+(?=[<])/)+"";var b=a.replace(/\./g,"<span class='break'> </span>.<span class='break'> </span>")+"";c=c.replace(/[^<>]+(?=[<])/,b);return c}function include(a){var a=publish.conf.templatesDir+a;return IO.readFile(a)}function makeSrcFile(b,d,a){if(JSDOC.opt.s){return}if(!a){a=b.replace(/\.\.?[\\\/]/g,"").replace(/[\\\/]/g,"_");a=a.replace(/\:/g,"_")}var c={path:b,name:a,charset:IO.encoding,hilited:""};if(defined(JSDOC.PluginManager)){JSDOC.PluginManager.run("onPublishSrc",c)}if(c.hilited){IO.saveFile(d,a+publish.conf.ext,c.hilited)}}function makeSignature(b){if(!b){return"()"}var a="("+b.filter(function(c){return c.name.indexOf(".")==-1}).map(function(c){return c.name}).join(", ")+")";return a}function resolveLinks(a,b){a=a.replace(/\{@link ([^}]+)\}/gi,function(e,f){f=f.trim();var d=f.indexOf(" ");if(d>0){var c=f.substring(d+1);f=f.substring(0,d);return new Link().toSymbol(f).withText(c)}else{return new Link().toSymbol(f)}});return a};