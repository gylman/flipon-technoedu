LOG.inform("XMLDOC.Parser loaded");XMLDOC.Parser={};XMLDOC.Parser.strictMode=true;XMLDOC.Parser.node=function(c,a,b){this.name=a;this.type=b||"ELEMENT";this.parent=c;this.charData="";this.attrs={};this.nodes=[];this.cPtr=0;XMLDOC.Parser.node.prototype.getAttributeNames=function(){var d=[];for(var e in this.attrs){d.push(e)}return d};XMLDOC.Parser.node.prototype.getAttribute=function(d){return this.attrs[d]};XMLDOC.Parser.node.prototype.setAttribute=function(d,e){this.attrs[d]=e};XMLDOC.Parser.node.prototype.getChild=function(d){return this.nodes[d]};XMLDOC.Parser.node.prototype.parentNode=function(){return this.parent};XMLDOC.Parser.node.prototype.firstChild=function(){return this.nodes[0]};XMLDOC.Parser.node.prototype.lastChild=function(){return this.nodes[this.nodes.length-1]};XMLDOC.Parser.node.prototype.nextSibling=function(){var d=this.parent;if(d&&(d.nodes.indexOf(this)+1!=d.nodes.length)){return d.getChild(d.nodes.indexOf(this)+1)}return null};XMLDOC.Parser.node.prototype.prevSibling=function(){var d=this.parent;if(d&&(d.nodes.indexOf(this)-1>=0)){return d.getChild(d.nodes.indexOf(this)-1)}return null}};XMLDOC.Parser.parse=function(c){var a=[];a=c.split("\r\n");c=a.join("\n");a=c.split("\r");c=a.join("\n");c.replace(/<\?XML .*\?>/i,"");c.replace(/<!DOCTYPE .*\>/i,"");var b=new XMLDOC.Parser.node(null,"ROOT","DOCUMENT");XMLDOC.Parser.eat(b,c);return b};XMLDOC.Parser.eat=function(j,i){var p=new RegExp("<(!|)(\\?|--|)((.|\\s)*?)\\2>","g");var z=/<!--((.|\s)*?)-->/;var b=/<\?((.|\s)*?)\?>/;var w=/<(.*?)( +([\w_\-]*)=(\"|')(.*)\4)*(\/)?>/;var o=/<(.*?)( +([\w_\-]*)=(\"|')(.*)\4)*>/;var m=/<(.*?)( +([\w_\-]*)=(\"|')(.*?)\4)*>((.|\s)*?)<\/\1>/;var r=new RegExp(" +([\\w_\\-]*)=(\"|')(.*?)\\2","g");var y;while((y=p.exec(i))!=null){if(y.index>0){var k=i.substring(0,y.index).replace(/^[ \t\n]+((.|\n)*?)[ \t\n]+$/,"$1");if(k.length>0&&(k!="\n")){var l=new XMLDOC.Parser.node(j,"","TEXT");l.charData=k;j.nodes.push(l)}p.lastIndex-=i.substring(0,y.index).length;i=i.substring(y.index)}if(z.test(y[0])){var c=new XMLDOC.Parser.node(j,"","COMMENT");c.charData=z.exec(y[0])[1];j.nodes.push(c);p.lastIndex-=y[0].length;i=i.replace(z,"")}else{if(b.test(y[0])){var v=new XMLDOC.Parser.node(j,"","PI");v.charData=b.exec(y[0])[1];j.nodes.push(v);p.lastIndex-=y[0].length;i=i.replace(b,"")}else{if(w.test(y[0])){var t=w.exec(y[0]);var u=new XMLDOC.Parser.node(j,t[1],"ELEMENT");var x;while((x=r.exec(t[2]))!=null){u.attrs[x[1]]=x[3]}if(t[6]=="/"){j.nodes.push(u);p.lastIndex-=t[0].length;i=i.replace(w,"")}else{var n=false;var s=o.exec(i);var h=new RegExp("</"+s[1]+">");var d=h.exec(i);if(XMLDOC.Parser.strictMode&&d==null){var g=new Error("Malformed XML passed to XMLDOC.Parser... Error contains malformed 'src'");g.src=i;throw g}else{if(d==null){j.nodes.push(u);i=i.replace(o,"");n=true}}if(!n){var f=m.exec(i);XMLDOC.Parser.eat(u,f[6]);j.nodes.push(u);i=i.replace(m,"")}}p.lastIndex=0}}}}i=i.replace(/^[ \t\n]+((.|\n)*?)[ \t\n]+$/,"$1");if(i.length>0&&(i!="\n")){var q=new XMLDOC.Parser.node(j,"","TEXT");q.charData=i;j.nodes.push(q)}};