var TestDoc={fails:0,plans:0,passes:0,results:[]};TestDoc.record=function(a){TestDoc.results.push(a);if(typeof a.verdict=="boolean"){if(a.verdict===false){TestDoc.fails++}if(a.verdict===true){TestDoc.passes++}}};TestDoc.prove=function(a){if(typeof document!="undefined"&&typeof document.write!="undefined"){if(TestDoc.console){print=function(b){TestDoc.console.appendChild(document.createTextNode(b+"\n"))}}else{print=function(b){document.write(b+"<br />")}}}TestDoc.run(TestDoc.readFile(a))};TestDoc.run=function(src){try{eval(src)}catch(e){print("# ERROR! "+e)}var chunks=src.split(/\/\*t:/);var run=function(chunk){var is=TestDoc.assertEquals;var isnt=TestDoc.assertNotEquals;var plan=TestDoc.plan;var requires=TestDoc.requires;try{eval(chunk)}catch(e){print("# ERROR! "+e)}};for(var start=-1,end=0;(start=src.indexOf("/*t:",end))>end;start=end){run(src.substring(start+4,(end=src.indexOf("*/",start))))}};TestDoc.Result=function(a,b){this.verdict=a;this.message=b};TestDoc.Result.prototype.toString=function(){if(typeof this.verdict=="boolean"){return(this.verdict?"ok":"not ok")+" "+(++TestDoc.report.counter)+" - "+this.message}return"# "+this.message};TestDoc.requires=function(a){if(!TestDoc.requires.loaded[a]){load(a);TestDoc.requires.loaded[a]=true}};TestDoc.requires.loaded={};TestDoc.report=function(){TestDoc.report.counter=0;print("1.."+TestDoc.plans);for(var a=0;a<TestDoc.results.length;a++){print(TestDoc.results[a])}print("----------------------------------------");if(TestDoc.fails==0&&TestDoc.passes==TestDoc.plans){print("All tests successful.")}else{print("Failed "+TestDoc.fails+"/"+TestDoc.plans+" tests, "+((TestDoc.plans==0)?0:Math.round(TestDoc.passes/(TestDoc.passes+TestDoc.fails)*10000)/100)+"% okay. Planned to run "+TestDoc.plans+", did run "+(TestDoc.passes+TestDoc.fails)+".")}};TestDoc.plan=function(b,a){TestDoc.plans+=b;TestDoc.record(new TestDoc.Result(null,a+" ("+b+" tests)"))};TestDoc.assertEquals=function(e,d,f){var c=(e==d);if(!c){f+="\n#\n# "+e+" does not equal "+d+"\n#"}TestDoc.record(new TestDoc.Result(c,f))};TestDoc.assertNotEquals=function(e,d,f){var c=(e!=d);if(!c){f+="\n#\n# "+e+" equals "+d+"\n#"}TestDoc.record(new TestDoc.Result(c,f))};TestDoc.readFile=(function(){if(typeof readFile=="function"){return function(a){var b=readFile(a);return b||""}}else{return function(b){var a;if(window.XMLHttpRequest){a=new XMLHttpRequest()}else{if(window.ActiveXObject){try{a=new ActiveXObject("Msxml2.XMLHTTP")}catch(c){try{a=new ActiveXObject("Microsoft.XMLHTTP")}catch(c){}}}}if(!a){throw"Cannot create HTTP Request."}a.open("GET",b,false);a.send("");if(a.readyState==4){if(a.status>=400){throw"The HTTP Request returned an error code: "+a.status}}return a.responseText||""}}})();